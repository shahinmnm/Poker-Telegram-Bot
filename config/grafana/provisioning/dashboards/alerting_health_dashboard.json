{
  "uid": "poker-alerting-health",
  "title": "Poker Bot - Alerting Pipeline Health",
  "tags": ["poker", "alerting", "phase1.5"],
  "timezone": "browser",
  "schemaVersion": 16,
  "version": 1,
  "panels": [
    {
      "id": 1,
      "title": "Alert Delivery Rate",
      "type": "graph",
      "targets": [
        {
          "expr": "rate(alert_bridge_alerts_processed_total[5m])",
          "legendFormat": "Processed/sec"
        },
        {
          "expr": "rate(alert_bridge_alerts_failed_total[5m])",
          "legendFormat": "Failed/sec"
        }
      ]
    },
    {
      "id": 2,
      "title": "Telegram API Success Rate",
      "type": "stat",
      "targets": [
        {
          "expr": "sum(rate(alert_bridge_alerts_processed_total[5m])) / (sum(rate(alert_bridge_alerts_processed_total[5m])) + sum(rate(alert_bridge_alerts_failed_total[5m])))",
          "legendFormat": "Success Rate"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percentunit",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"value": 0, "color": "red"},
              {"value": 0.95, "color": "yellow"},
              {"value": 0.99, "color": "green"}
            ]
          }
        }
      }
    },
    {
      "id": 3,
      "title": "Alert Severity Distribution",
      "type": "piechart",
      "targets": [
        {
          "expr": "sum by (severity) (increase(alert_bridge_alerts_processed_total[1h]))",
          "legendFormat": "{{severity}}"
        }
      ]
    },
    {
      "id": 4,
      "title": "Alertmanager Firing Alerts",
      "type": "graph",
      "targets": [
        {
          "expr": "ALERTS{alertstate=\"firing\"}",
          "legendFormat": "{{alertname}}"
        }
      ]
    }
  ],
  "refresh": "30s",
  "time": {"from": "now-3h", "to": "now"}
}
